"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[6734],{97052:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"services","title":"Services","description":"Services are server-side singletons that handle your game logic. Each Service manages a specific domain of your game\u2014combat, inventory, matchmaking, etc.","source":"@site/docs/services.md","sourceDirName":".","slug":"/services","permalink":"/e2en/docs/services","draft":false,"unlisted":false,"editUrl":"https://github.com/estrogenie/e2en/edit/master/docs/services.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"defaultSidebar","previous":{"title":"Getting Started","permalink":"/e2en/docs/getting-started"},"next":{"title":"Controllers","permalink":"/e2en/docs/controllers"}}');var t=r(74848),a=r(28453);const l={sidebar_position:3},s="Services",c={},o=[{value:"Creating a Service",id:"creating-a-service",level:2},{value:"Service Definition",id:"service-definition",level:2},{value:"The Client Table",id:"the-client-table",level:2},{value:"Functions (Remote Methods)",id:"functions-remote-methods",level:3},{value:"Signals (Remote Events)",id:"signals-remote-events",level:3},{value:"Properties (Replicated State)",id:"properties-replicated-state",level:3},{value:"Accessing Other Services",id:"accessing-other-services",level:2},{value:"Custom Properties and Methods",id:"custom-properties-and-methods",level:2},{value:"Loading Services",id:"loading-services",level:2},{value:"Automatic (Recommended)",id:"automatic-recommended",level:3},{value:"Manual Loading",id:"manual-loading",level:3},{value:"Example: Complete Service",id:"example-complete-service",level:2}];function d(e){const n={admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,a.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"services",children:"Services"})}),"\n",(0,t.jsx)(n.p,{children:"Services are server-side singletons that handle your game logic. Each Service manages a specific domain of your game\u2014combat, inventory, matchmaking, etc."}),"\n",(0,t.jsx)(n.h2,{id:"creating-a-service",children:"Creating a Service"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:'local root = script.Parent.Parent.Parent\nlocal Types = require(root.Types)\n\nlocal e2en: Types.e2enServer = require(root) :: any\n\nlocal InventoryService = e2en.CreateService({\n    Name = "InventoryService",\n})\n\nfunction InventoryService:Init()\n    -- Setup code\nend\n\nfunction InventoryService:Start()\n    -- Game loop code\nend\n\nreturn InventoryService\n'})}),"\n",(0,t.jsx)(n.h2,{id:"service-definition",children:"Service Definition"}),"\n",(0,t.jsxs)(n.p,{children:["The table passed to ",(0,t.jsx)(n.code,{children:"CreateService"})," can include:"]}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Field"}),(0,t.jsx)(n.th,{children:"Type"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"Name"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"string"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.strong,{children:"Required."})," Unique identifier for the service."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"Client"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"table"})}),(0,t.jsx)(n.td,{children:"Methods, signals, and properties exposed to clients."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"Dependencies"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"{string}"})}),(0,t.jsx)(n.td,{children:"Services that must initialize before this one."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"Init"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"function"})}),(0,t.jsx)(n.td,{children:"Called synchronously during startup."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"Start"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"function"})}),(0,t.jsx)(n.td,{children:"Called asynchronously after all services initialize."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.em,{children:"custom"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"any"})}),(0,t.jsx)(n.td,{children:"Any other fields become part of the service table."})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"the-client-table",children:"The Client Table"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"Client"})," table defines what clients can access. It supports three types of entries:"]}),"\n",(0,t.jsx)(n.h3,{id:"functions-remote-methods",children:"Functions (Remote Methods)"}),"\n",(0,t.jsx)(n.p,{children:"Functions in the Client table become callable from clients:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:"local ShopService = e2en.CreateService({\n    Name = \"ShopService\",\n    Client = {\n        PurchaseItem = function(self, player: Player, itemId: string): boolean\n            -- 'self' is the Client table\n            -- 'player' is automatically injected\n            if not hasEnoughGold(player, itemId) then\n                return false\n            end\n            giveItem(player, itemId)\n            return true\n        end,\n    },\n})\n"})}),"\n",(0,t.jsx)(n.p,{children:"On the client:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:'local ShopService = e2en.GetService("ShopService")\nlocal success = ShopService:PurchaseItem("sword_01")\n'})}),"\n",(0,t.jsxs)(n.admonition,{title:"Validate Client Input",type:"caution",children:[(0,t.jsx)(n.p,{children:"Never trust data from clients. Always validate:"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:'PurchaseItem = function(self, player: Player, itemId: any): boolean\n    if typeof(itemId) ~= "string" then\n        return false\n    end\n    -- Now safe to use\nend\n'})})]}),"\n",(0,t.jsx)(n.h3,{id:"signals-remote-events",children:"Signals (Remote Events)"}),"\n",(0,t.jsxs)(n.p,{children:["Use ",(0,t.jsx)(n.code,{children:"CreateSignal()"})," for events you want to fire to clients:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:'local CombatService = e2en.CreateService({\n    Name = "CombatService",\n    Client = {\n        DamageDealt = e2en.CreateSignal(),\n        PlayerKilled = e2en.CreateSignal(),\n    },\n})\n\n-- Fire to a specific player\nself.Client.DamageDealt:Fire(player, { amount = 25, source = "Enemy" })\n\n-- Fire to all players\nself.Client.PlayerKilled:FireAll({ victim = player.Name, killer = enemyName })\n'})}),"\n",(0,t.jsx)(n.p,{children:"Clients can also fire signals back to the server:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:"-- Server\nself.Client.DamageDealt:Connect(function(player, data)\n    -- Handle client-sent event\n    -- Always validate!\nend)\n"})}),"\n",(0,t.jsx)(n.p,{children:"For high-frequency, loss-tolerant data (like position updates), use unreliable signals:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:"Client = {\n    PositionUpdate = e2en.CreateUnreliableSignal(),\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"properties-replicated-state",children:"Properties (Replicated State)"}),"\n",(0,t.jsxs)(n.p,{children:["Use ",(0,t.jsx)(n.code,{children:"CreateProperty()"})," for state that should sync to clients:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:'local GameService = e2en.CreateService({\n    Name = "GameService",\n    Client = {\n        GamePhase = e2en.CreateProperty("Waiting"),\n        PlayerScores = e2en.CreateProperty({}),\n    },\n})\n\n-- Set for all players\nself.Client.GamePhase:Set("Playing")\n\n-- Set for a specific player\nself.Client.PlayerScores:SetFor(player, { kills = 5, deaths = 2 })\n'})}),"\n",(0,t.jsx)(n.h2,{id:"accessing-other-services",children:"Accessing Other Services"}),"\n",(0,t.jsxs)(n.p,{children:["Use ",(0,t.jsx)(n.code,{children:"GetService()"})," to access other services:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:'function InventoryService:Start()\n    local DataService = e2en.GetService("DataService")\n    local PlayerService = e2en.GetService("PlayerService")\nend\n'})}),"\n",(0,t.jsxs)(n.p,{children:["If you need a service during ",(0,t.jsx)(n.code,{children:"Init()"}),", declare it as a dependency:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:'local InventoryService = e2en.CreateService({\n    Name = "InventoryService",\n    Dependencies = { "DataService" },\n})\n\nfunction InventoryService:Init()\n    -- DataService is guaranteed to be initialized\n    self._dataService = e2en.GetService("DataService")\nend\n'})}),"\n",(0,t.jsx)(n.h2,{id:"custom-properties-and-methods",children:"Custom Properties and Methods"}),"\n",(0,t.jsx)(n.p,{children:"Add any properties or methods you need:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:'local MatchService = e2en.CreateService({\n    Name = "MatchService",\n\n    -- Custom properties\n    _matches = {},\n    _config = {\n        maxPlayersPerMatch = 10,\n        matchDuration = 300,\n    },\n})\n\n-- Custom methods\nfunction MatchService:CreateMatch(players: {Player})\n    local match = {\n        id = HttpService:GenerateGUID(),\n        players = players,\n        startTime = os.clock(),\n    }\n    self._matches[match.id] = match\n    return match\nend\n\nfunction MatchService:EndMatch(matchId: string)\n    local match = self._matches[matchId]\n    if match then\n        -- Cleanup logic\n        self._matches[matchId] = nil\n    end\nend\n'})}),"\n",(0,t.jsx)(n.h2,{id:"loading-services",children:"Loading Services"}),"\n",(0,t.jsx)(n.h3,{id:"automatic-recommended",children:"Automatic (Recommended)"}),"\n",(0,t.jsxs)(n.p,{children:["When you call ",(0,t.jsx)(n.code,{children:"e2en.Run()"}),", it automatically loads all Services from the ",(0,t.jsx)(n.code,{children:"Systems/"})," folder:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Systems/\n\u251c\u2500\u2500 Combat/\n\u2502   \u2514\u2500\u2500 Service.luau  \u2190 Loaded automatically\n\u251c\u2500\u2500 Inventory/\n\u2502   \u2514\u2500\u2500 Service.luau  \u2190 Loaded automatically\n"})}),"\n",(0,t.jsx)(n.h3,{id:"manual-loading",children:"Manual Loading"}),"\n",(0,t.jsx)(n.p,{children:"For more control, use the loading methods:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:"-- Load direct children\ne2en.AddServices(someFolder)\n\n-- Load all descendants\ne2en.AddServicesDeep(someFolder)\n\n-- Load Service.luau from immediate child folders\ne2en.AddSystems(someFolder)\n\n-- Load Service.luau from all descendant folders\ne2en.AddSystemsDeep(someFolder)\n"})}),"\n",(0,t.jsx)(n.h2,{id:"example-complete-service",children:"Example: Complete Service"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:'local root = script.Parent.Parent.Parent\nlocal Types = require(root.Types)\n\nlocal e2en: Types.e2enServer = require(root) :: any\n\nlocal CurrencyService = e2en.CreateService({\n    Name = "CurrencyService",\n    Dependencies = { "DataService" },\n\n    Client = {\n        CoinsChanged = e2en.CreateSignal(),\n        Coins = e2en.CreateProperty(0),\n\n        GetCoins = function(self, player: Player): number\n            return self.Server:GetCoins(player)\n        end,\n    },\n\n    _playerCoins = {},\n})\n\nfunction CurrencyService:Init()\n    self._dataService = e2en.GetService("DataService")\nend\n\nfunction CurrencyService:Start()\n    e2en.OnPlayerAdded(function(player, trove)\n        local data = self._dataService:GetData(player)\n        self._playerCoins[player] = data.coins or 0\n        self.Client.Coins:SetFor(player, self._playerCoins[player])\n    end)\n\n    e2en.OnPlayerRemoving(function(player)\n        self._playerCoins[player] = nil\n    end)\nend\n\nfunction CurrencyService:GetCoins(player: Player): number\n    return self._playerCoins[player] or 0\nend\n\nfunction CurrencyService:AddCoins(player: Player, amount: number)\n    local current = self:GetCoins(player)\n    local newAmount = current + amount\n    self._playerCoins[player] = newAmount\n    self.Client.Coins:SetFor(player, newAmount)\n    self.Client.CoinsChanged:Fire(player, { old = current, new = newAmount })\nend\n\nreturn CurrencyService\n'})})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},28453:(e,n,r)=>{r.d(n,{R:()=>l,x:()=>s});var i=r(96540);const t={},a=i.createContext(t);function l(e){const n=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),i.createElement(a.Provider,{value:n},e.children)}}}]);