"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[4559],{65679:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>i,metadata:()=>l,toc:()=>s});const l=JSON.parse('{"id":"controllers","title":"Controllers","description":"Controllers are client-side singletons that handle local game logic, UI, and player input. They communicate with Services to perform server-authoritative actions.","source":"@site/docs/controllers.md","sourceDirName":".","slug":"/controllers","permalink":"/e2en/docs/controllers","draft":false,"unlisted":false,"editUrl":"https://github.com/estrogenie/e2en/edit/master/docs/controllers.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"defaultSidebar","previous":{"title":"Services","permalink":"/e2en/docs/services"},"next":{"title":"Communication","permalink":"/e2en/docs/communication"}}');var t=r(74848),o=r(28453);const i={sidebar_position:4},a="Controllers",c={},s=[{value:"Creating a Controller",id:"creating-a-controller",level:2},{value:"Controller Definition",id:"controller-definition",level:2},{value:"Accessing Server Services",id:"accessing-server-services",level:2},{value:"Accessing Other Controllers",id:"accessing-other-controllers",level:2},{value:"Working with UI",id:"working-with-ui",level:2},{value:"UI Reference Pattern",id:"ui-reference-pattern",level:3},{value:"Why Module Scope?",id:"why-module-scope",level:3},{value:"Player Reference",id:"player-reference",level:2},{value:"Character Access",id:"character-access",level:2},{value:"Input Handling",id:"input-handling",level:2},{value:"Loading Controllers",id:"loading-controllers",level:2},{value:"Automatic (Recommended)",id:"automatic-recommended",level:3},{value:"Manual Loading",id:"manual-loading",level:3},{value:"Example: Complete Controller",id:"example-complete-controller",level:2}];function d(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"controllers",children:"Controllers"})}),"\n",(0,t.jsx)(n.p,{children:"Controllers are client-side singletons that handle local game logic, UI, and player input. They communicate with Services to perform server-authoritative actions."}),"\n",(0,t.jsx)(n.h2,{id:"creating-a-controller",children:"Creating a Controller"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:'local root = script.Parent.Parent.Parent\nlocal Types = require(root.Types)\n\nlocal e2en: Types.e2enClient = require(root) :: any\n\nlocal InventoryController = e2en.CreateController({\n    Name = "InventoryController",\n})\n\nfunction InventoryController:Init()\n    -- Setup code\nend\n\nfunction InventoryController:Start()\n    -- Runtime code\nend\n\nreturn InventoryController\n'})}),"\n",(0,t.jsx)(n.h2,{id:"controller-definition",children:"Controller Definition"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Field"}),(0,t.jsx)(n.th,{children:"Type"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"Name"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"string"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.strong,{children:"Required."})," Unique identifier for the controller."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"Dependencies"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"{string}"})}),(0,t.jsx)(n.td,{children:"Controllers that must initialize before this one."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"Init"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"function"})}),(0,t.jsx)(n.td,{children:"Called synchronously during startup."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"Start"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"function"})}),(0,t.jsx)(n.td,{children:"Called asynchronously after all controllers initialize."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.em,{children:"custom"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"any"})}),(0,t.jsx)(n.td,{children:"Any other fields become part of the controller table."})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"accessing-server-services",children:"Accessing Server Services"}),"\n",(0,t.jsxs)(n.p,{children:["Use ",(0,t.jsx)(n.code,{children:"GetService()"})," to get a proxy to a server Service:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:'function InventoryController:Start()\n    local InventoryService = e2en.GetService("InventoryService")\n\n    -- Call server methods\n    local items = InventoryService:GetItems()\n\n    -- Listen to server signals\n    InventoryService.ItemAdded:Connect(function(item)\n        self:OnItemAdded(item)\n    end)\n\n    -- Observe replicated properties\n    InventoryService.InventorySize:Observe(function(size)\n        self:UpdateInventoryUI(size)\n    end)\nend\n'})}),"\n",(0,t.jsx)(n.h2,{id:"accessing-other-controllers",children:"Accessing Other Controllers"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:'function InventoryController:Start()\n    local UIController = e2en.GetController("UIController")\n    UIController:ShowInventory()\nend\n'})}),"\n",(0,t.jsxs)(n.p,{children:["For ",(0,t.jsx)(n.code,{children:"Init()"})," dependencies:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:'local InventoryController = e2en.CreateController({\n    Name = "InventoryController",\n    Dependencies = { "UIController" },\n})\n\nfunction InventoryController:Init()\n    self._uiController = e2en.GetController("UIController")\nend\n'})}),"\n",(0,t.jsx)(n.h2,{id:"working-with-ui",children:"Working with UI"}),"\n",(0,t.jsx)(n.p,{children:"Controllers are the natural place for UI logic. e2en provides patterns for clean UI code."}),"\n",(0,t.jsx)(n.h3,{id:"ui-reference-pattern",children:"UI Reference Pattern"}),"\n",(0,t.jsxs)(n.p,{children:["Initialize UI references at module scope using ",(0,t.jsx)(n.code,{children:"WaitForChild"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:'local Players = game:GetService("Players")\nlocal player = Players.LocalPlayer\nlocal PlayerGui = player.PlayerGui\n\nlocal root = script.Parent.Parent.Parent\nlocal Types = require(root.Types)\n\nlocal e2en: Types.e2enClient = require(root) :: any\n\nlocal InventoryController = e2en.CreateController({ Name = "InventoryController" })\n\n-- UI references at module scope\nlocal InventoryGui              = PlayerGui:WaitForChild("Inventory") :: ScreenGui\nlocal MainFrame                 = InventoryGui:WaitForChild("Main") :: Frame\nlocal ItemsContainer            = MainFrame:WaitForChild("Items") :: ScrollingFrame\nlocal CloseButton               = MainFrame:WaitForChild("Close") :: TextButton\n\nfunction InventoryController:Init()\n    -- Wire up events\n    CloseButton.Activated:Connect(function()\n        self:Hide()\n    end)\nend\n\nfunction InventoryController:Show()\n    InventoryGui.Enabled = true\nend\n\nfunction InventoryController:Hide()\n    InventoryGui.Enabled = false\nend\n\nreturn InventoryController\n'})}),"\n",(0,t.jsx)(n.h3,{id:"why-module-scope",children:"Why Module Scope?"}),"\n",(0,t.jsxs)(n.p,{children:["Initializing UI at module scope instead of ",(0,t.jsx)(n.code,{children:"Init()"}),":"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Fails fast"})," - Missing UI elements error immediately on require"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Clear dependencies"})," - All UI refs visible at top of file"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Type safety"})," - Cast types once, use everywhere"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"No nil checks"})," - Guaranteed to exist after module loads"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"player-reference",children:"Player Reference"}),"\n",(0,t.jsxs)(n.p,{children:["Access the local player via ",(0,t.jsx)(n.code,{children:"e2en.Player"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:'function MyController:Start()\n    local player = e2en.Player\n    print("Local player:", player.Name)\nend\n'})}),"\n",(0,t.jsx)(n.h2,{id:"character-access",children:"Character Access"}),"\n",(0,t.jsx)(n.p,{children:"Get the current character or respond to character events:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:'function MyController:Start()\n    -- Get current character (may be nil)\n    local character = e2en.GetCharacter()\n\n    -- React to character spawns\n    e2en.OnCharacterAdded(function(character, trove)\n        local humanoid = character:WaitForChild("Humanoid")\n\n        -- Auto-cleanup when character dies\n        trove:Connect(humanoid.Died, function()\n            self:OnDied()\n        end)\n    end)\nend\n'})}),"\n",(0,t.jsx)(n.h2,{id:"input-handling",children:"Input Handling"}),"\n",(0,t.jsx)(n.p,{children:"Controllers handle player input:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:'local UserInputService = game:GetService("UserInputService")\nlocal ContextActionService = game:GetService("ContextActionService")\n\nlocal InputController = e2en.CreateController({ Name = "InputController" })\n\nfunction InputController:Init()\n    ContextActionService:BindAction(\n        "OpenInventory",\n        function(_, state)\n            if state == Enum.UserInputState.Begin then\n                local InventoryController = e2en.GetController("InventoryController")\n                InventoryController:Toggle()\n            end\n        end,\n        false,\n        Enum.KeyCode.I\n    )\nend\n\nreturn InputController\n'})}),"\n",(0,t.jsx)(n.h2,{id:"loading-controllers",children:"Loading Controllers"}),"\n",(0,t.jsx)(n.h3,{id:"automatic-recommended",children:"Automatic (Recommended)"}),"\n",(0,t.jsxs)(n.p,{children:["The client automatically loads Controllers from ",(0,t.jsx)(n.code,{children:"Systems/"})," folders:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Systems/\n\u251c\u2500\u2500 Combat/\n\u2502   \u2514\u2500\u2500 Controller.luau  \u2190 Loaded automatically\n\u251c\u2500\u2500 UI/\n\u2502   \u2514\u2500\u2500 Controller.luau  \u2190 Loaded automatically\n"})}),"\n",(0,t.jsx)(n.h3,{id:"manual-loading",children:"Manual Loading"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:"-- Load direct children\ne2en.AddControllers(someFolder)\n\n-- Load all descendants\ne2en.AddControllersDeep(someFolder)\n\n-- Load Controller.luau from immediate child folders\ne2en.AddSystems(someFolder)\n\n-- Load Controller.luau from all descendant folders\ne2en.AddSystemsDeep(someFolder)\n"})}),"\n",(0,t.jsx)(n.h2,{id:"example-complete-controller",children:"Example: Complete Controller"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:'local Players = game:GetService("Players")\nlocal player = Players.LocalPlayer\nlocal PlayerGui = player.PlayerGui\n\nlocal root = script.Parent.Parent.Parent\nlocal Types = require(root.Types)\n\nlocal e2en: Types.e2enClient = require(root) :: any\n\nlocal ShopController = e2en.CreateController({\n    Name = "ShopController",\n    Dependencies = { "NotificationController" },\n})\n\n-- UI references\nlocal ShopGui               = PlayerGui:WaitForChild("Shop") :: ScreenGui\nlocal MainFrame             = ShopGui:WaitForChild("Main") :: Frame\nlocal ItemsContainer        = MainFrame:WaitForChild("Items") :: ScrollingFrame\nlocal CloseButton           = MainFrame:WaitForChild("Close") :: TextButton\nlocal CoinsLabel            = MainFrame:WaitForChild("Coins") :: TextLabel\n\n-- Template\nlocal ItemTemplate          = ItemsContainer:WaitForChild("Template") :: Frame\n\nfunction ShopController:Init()\n    self._notifications = e2en.GetController("NotificationController")\n    self._shopService = nil -- Set in Start\n\n    CloseButton.Activated:Connect(function()\n        self:Hide()\n    end)\nend\n\nfunction ShopController:Start()\n    self._shopService = e2en.GetService("ShopService")\n\n    -- Update coins display\n    self._shopService.Coins:Observe(function(coins)\n        CoinsLabel.Text = tostring(coins)\n    end)\n\n    -- Populate items\n    self:PopulateItems()\nend\n\nfunction ShopController:PopulateItems()\n    local items = self._shopService:GetItems()\n\n    for _, item in items do\n        local itemFrame = ItemTemplate:Clone()\n        itemFrame.Name = item.id\n        itemFrame.ItemName.Text = item.name\n        itemFrame.Price.Text = tostring(item.price)\n        itemFrame.Visible = true\n\n        itemFrame.BuyButton.Activated:Connect(function()\n            self:TryPurchase(item.id)\n        end)\n\n        itemFrame.Parent = ItemsContainer\n    end\nend\n\nfunction ShopController:TryPurchase(itemId: string)\n    local success = self._shopService:Purchase(itemId)\n\n    if success then\n        self._notifications:Show("Purchase successful!")\n    else\n        self._notifications:Show("Not enough coins!")\n    end\nend\n\nfunction ShopController:Show()\n    ShopGui.Enabled = true\nend\n\nfunction ShopController:Hide()\n    ShopGui.Enabled = false\nend\n\nreturn ShopController\n'})})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},28453:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>a});var l=r(96540);const t={},o=l.createContext(t);function i(e){const n=l.useContext(o);return l.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),l.createElement(o.Provider,{value:n},e.children)}}}]);