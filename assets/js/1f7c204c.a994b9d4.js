"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[5873],{13410:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>c,default:()=>p,frontMatter:()=>l,metadata:()=>o,toc:()=>r});const o=JSON.parse('{"id":"components","title":"Components","description":"Components bind Luau classes to Roblox instances via CollectionService tags. When an instance gains a tag, a component is created. When the tag is removed or the instance is destroyed, the component cleans up automatically.","source":"@site/docs/components.md","sourceDirName":".","slug":"/components","permalink":"/e2en/docs/components","draft":false,"unlisted":false,"editUrl":"https://github.com/estrogenie/e2en/edit/master/docs/components.md","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"sidebar_position":7},"sidebar":"defaultSidebar","previous":{"title":"Lifecycle","permalink":"/e2en/docs/lifecycle"},"next":{"title":"Utilities","permalink":"/e2en/docs/utilities"}}');var a=t(74848),s=t(28453);const l={sidebar_position:7},c="Components",i={},r=[{value:"Creating a Component",id:"creating-a-component",level:2},{value:"Component Lifecycle",id:"component-lifecycle",level:2},{value:"Configuration",id:"configuration",level:2},{value:"The Prototype",id:"the-prototype",level:2},{value:"Built-in Properties",id:"built-in-properties",level:2},{value:"Update Loops",id:"update-loops",level:2},{value:"Accessing Components",id:"accessing-components",level:2},{value:"Get Component from Instance",id:"get-component-from-instance",level:3},{value:"Get All Active Components",id:"get-all-active-components",level:3},{value:"Wait for Component",id:"wait-for-component",level:3},{value:"Component Signals",id:"component-signals",level:2},{value:"Using Trove",id:"using-trove",level:2},{value:"Destroying Components",id:"destroying-components",level:2},{value:"Remove Tag",id:"remove-tag",level:3},{value:"Destroy Instance",id:"destroy-instance",level:3},{value:"Destroy Component Class",id:"destroy-component-class",level:3},{value:"Example: Collectible",id:"example-collectible",level:2},{value:"Best Practices",id:"best-practices",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"components",children:"Components"})}),"\n",(0,a.jsx)(n.p,{children:"Components bind Luau classes to Roblox instances via CollectionService tags. When an instance gains a tag, a component is created. When the tag is removed or the instance is destroyed, the component cleans up automatically."}),"\n",(0,a.jsx)(n.h2,{id:"creating-a-component",children:"Creating a Component"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:'local root = script.Parent.Parent.Parent\nlocal Component = require(root.Libraries.Component)\n\nlocal Lava = Component.new({\n    Tag = "Lava",\n    Ancestors = { workspace },  -- Optional: only track in workspace\n})\n\n-- Define properties on the prototype\nLava._prototype.Damage = 10\nLava._prototype.DamageInterval = 0.5\n\n-- Lifecycle methods\nfunction Lava._prototype:Construct()\n    -- Called when component is created\n    print("Lava created on", self.Instance.Name)\nend\n\nfunction Lava._prototype:Start()\n    -- Called after Construct, safe to interact with other components\n    self._lastDamageTime = {}\n\n    self._trove:Connect(self.Instance.Touched, function(hit)\n        self:OnTouched(hit)\n    end)\nend\n\nfunction Lava._prototype:Stop()\n    -- Called before cleanup\n    print("Lava removed from", self.Instance.Name)\nend\n\n-- Custom methods\nfunction Lava._prototype:OnTouched(hit: BasePart)\n    local character = hit.Parent\n    local humanoid = character and character:FindFirstChild("Humanoid") :: Humanoid?\n\n    if humanoid and humanoid.Health > 0 then\n        local now = os.clock()\n        local lastDamage = self._lastDamageTime[character] or 0\n\n        if now - lastDamage >= self.DamageInterval then\n            humanoid:TakeDamage(self.Damage)\n            self._lastDamageTime[character] = now\n        end\n    end\nend\n\n-- Start tracking tagged instances\nLava:Start()\n\nreturn Lava\n'})}),"\n",(0,a.jsx)(n.h2,{id:"component-lifecycle",children:"Component Lifecycle"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:'Instance tagged with "Lava"\n         \u2502\n         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Construct()   \u2502  Component instance created\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502     Start()     \u2502  Safe to interact with world\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u2502  (component active...)\n         \u2502\n         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502     Stop()      \u2502  Cleanup begins\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u25bc\n   _trove:Clean()    Automatic cleanup\n         \u2502\n         \u25bc\n  Component destroyed\n'})}),"\n",(0,a.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:'local MyComponent = Component.new({\n    Tag = "MyTag",           -- Required: CollectionService tag\n    Ancestors = { workspace, ReplicatedStorage },  -- Optional: only track in these\n})\n'})}),"\n",(0,a.jsxs)(n.p,{children:["If ",(0,a.jsx)(n.code,{children:"Ancestors"})," is not specified, all tagged instances are tracked regardless of location."]}),"\n",(0,a.jsx)(n.h2,{id:"the-prototype",children:"The Prototype"}),"\n",(0,a.jsxs)(n.p,{children:["Define properties and methods on ",(0,a.jsx)(n.code,{children:"_prototype"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:"-- Properties (copied to each instance)\nMyComponent._prototype.Speed = 10\nMyComponent._prototype.MaxHealth = 100\n\n-- Methods (shared via metatable)\nfunction MyComponent._prototype:TakeDamage(amount)\n    self.Health = math.max(0, self.Health - amount)\nend\n"})}),"\n",(0,a.jsx)(n.h2,{id:"built-in-properties",children:"Built-in Properties"}),"\n",(0,a.jsx)(n.p,{children:"Every component instance has:"}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Property"}),(0,a.jsx)(n.th,{children:"Type"}),(0,a.jsx)(n.th,{children:"Description"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"Instance"})}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"Instance"})}),(0,a.jsx)(n.td,{children:"The tagged Roblox instance"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"_trove"})}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"Trove"})}),(0,a.jsx)(n.td,{children:"Auto-cleans when component is destroyed"})]})]})]}),"\n",(0,a.jsx)(n.h2,{id:"update-loops",children:"Update Loops"}),"\n",(0,a.jsx)(n.p,{children:"Components can opt into per-frame updates:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:"-- Called every Heartbeat\nfunction MyComponent._prototype:HeartbeatUpdate(dt: number)\n    self.Instance.CFrame *= CFrame.Angles(0, dt, 0)\nend\n\n-- Called every RenderStepped (client only)\nfunction MyComponent._prototype:RenderSteppedUpdate(dt: number)\n    -- Client-side rendering logic\nend\n"})}),"\n",(0,a.jsx)(n.p,{children:"Update methods are only connected if they're defined on the prototype."}),"\n",(0,a.jsx)(n.h2,{id:"accessing-components",children:"Accessing Components"}),"\n",(0,a.jsx)(n.h3,{id:"get-component-from-instance",children:"Get Component from Instance"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:'local lavaComponent = Lava:FromInstance(somePart)\n\nif lavaComponent then\n    print("Damage:", lavaComponent.Damage)\n    lavaComponent.Damage = 20  -- Modify this instance\nend\n'})}),"\n",(0,a.jsx)(n.h3,{id:"get-all-active-components",children:"Get All Active Components"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:'local allLava = Lava:GetAll()\n\nfor _, component in allLava do\n    print(component.Instance.Name, "deals", component.Damage, "damage")\nend\n'})}),"\n",(0,a.jsx)(n.h3,{id:"wait-for-component",children:"Wait for Component"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:'-- Yields until component exists (with timeout)\nlocal component = Lava:WaitForInstance(somePart, 5)\n\nif component then\n    print("Found!")\nelse\n    print("Timed out")\nend\n'})}),"\n",(0,a.jsx)(n.h2,{id:"component-signals",children:"Component Signals"}),"\n",(0,a.jsx)(n.p,{children:"React to components being added or removed:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:'Lava.ComponentAdded:Connect(function(component)\n    print("New lava on", component.Instance.Name)\nend)\n\nLava.ComponentRemoving:Connect(function(component)\n    print("Lava being removed from", component.Instance.Name)\nend)\n'})}),"\n",(0,a.jsx)(n.h2,{id:"using-trove",children:"Using Trove"}),"\n",(0,a.jsxs)(n.p,{children:["Each component has a ",(0,a.jsx)(n.code,{children:"_trove"})," that auto-cleans when destroyed:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:'function MyComponent._prototype:Start()\n    -- Connections auto-disconnect\n    self._trove:Connect(self.Instance.Touched, function(hit)\n        self:OnTouched(hit)\n    end)\n\n    -- Instances auto-destroy\n    local highlight = Instance.new("Highlight")\n    self._trove:Add(highlight)\n    highlight.Parent = self.Instance\n\n    -- Custom cleanup\n    local resource = createResource()\n    self._trove:Add(resource, "Release")\nend\n'})}),"\n",(0,a.jsx)(n.h2,{id:"destroying-components",children:"Destroying Components"}),"\n",(0,a.jsx)(n.h3,{id:"remove-tag",children:"Remove Tag"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:'-- Component is destroyed when tag is removed\nlocal CollectionService = game:GetService("CollectionService")\nCollectionService:RemoveTag(part, "Lava")\n'})}),"\n",(0,a.jsx)(n.h3,{id:"destroy-instance",children:"Destroy Instance"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:"-- Component is destroyed when instance is destroyed\npart:Destroy()\n"})}),"\n",(0,a.jsx)(n.h3,{id:"destroy-component-class",children:"Destroy Component Class"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:"-- Stops tracking and destroys all instances\nLava:Destroy()\n"})}),"\n",(0,a.jsx)(n.h2,{id:"example-collectible",children:"Example: Collectible"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:'local Component = require(root.Libraries.Component)\n\nlocal Collectible = Component.new({\n    Tag = "Collectible",\n    Ancestors = { workspace },\n})\n\nCollectible._prototype.Value = 10\nCollectible._prototype.RespawnTime = 30\n\nfunction Collectible._prototype:Construct()\n    self._originalCFrame = self.Instance.CFrame\n    self._collected = false\nend\n\nfunction Collectible._prototype:Start()\n    self._trove:Connect(self.Instance.Touched, function(hit)\n        self:OnTouched(hit)\n    end)\nend\n\nfunction Collectible._prototype:HeartbeatUpdate(dt: number)\n    if not self._collected then\n        -- Spin and bob\n        local time = os.clock()\n        self.Instance.CFrame = self._originalCFrame\n            * CFrame.Angles(0, time * 2, 0)\n            * CFrame.new(0, math.sin(time * 3) * 0.5, 0)\n    end\nend\n\nfunction Collectible._prototype:OnTouched(hit: BasePart)\n    if self._collected then return end\n\n    local player = game.Players:GetPlayerFromCharacter(hit.Parent)\n    if not player then return end\n\n    self._collected = true\n    self.Instance.Transparency = 1\n\n    -- Award points (via service)\n    local PointsService = e2en.GetService("PointsService")\n    PointsService:AddPoints(player, self.Value)\n\n    -- Respawn after delay\n    task.delay(self.RespawnTime, function()\n        if self.Instance and self.Instance.Parent then\n            self._collected = false\n            self.Instance.Transparency = 0\n        end\n    end)\nend\n\nCollectible:Start()\n\nreturn Collectible\n'})}),"\n",(0,a.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Keep components focused"})," - One responsibility per component"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Use Trove"})," - Always clean up via ",(0,a.jsx)(n.code,{children:"_trove"}),", not manual tracking"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Validate Instance"})," - Check ",(0,a.jsx)(n.code,{children:"self.Instance"})," still exists in delayed callbacks"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Ancestors filter"})," - Use ",(0,a.jsx)(n.code,{children:"Ancestors"})," to avoid tracking instances in unexpected places"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"HeartbeatUpdate for logic"})," - Use ",(0,a.jsx)(n.code,{children:"RenderSteppedUpdate"})," only for visual client-side updates"]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>l,x:()=>c});var o=t(96540);const a={},s=o.createContext(a);function l(e){const n=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:l(e.components),o.createElement(s.Provider,{value:n},e.children)}}}]);